<div id="easy-find">
    <div id="facets" class="col-md-3">
        <h3>Filter</h3>
        <p>Filter facets here</p>
    </div>
    <div id="bentos">
        <div id="summon-search" class="col-md-4">
            <h3>Articles</h3>
            <ul></ul>
            <div class="more"></div>
        </div>
        <div id="books" class="col-md-4">
            <h3>Books</h3>
            <ul></ul>
            <div class="more"></div>
        </div>
    </div>
</div>


<%# Link to JSON data rout %>
<span id="path" class="hidden"><%= data_link(params[:q]) =%></span>

<script type="text/javascript">
  $(document).ready(function() {
    var query = getParameterByName('q');
    if (query == "") {
        console.debug('no query');
        $('#bentos').html('<h3>No query provided.</h3>')
    } else {
        //do_bento_madness
        bento(query);
    };
});

function bento(query) {
    var dataUrl = $('#path').text();
    $.ajax(dataUrl, {
      success: function(response) {
        //$("#bdr-search").html(response);
        $.each(response, function(i, obj) {
            var title = obj['title'];
            $('#summon-search ul').append('<li><a href="' + obj['link'] + '">' + title + '</a></li>');
        });
        var more = "http://brown.preview.summon.serialssolutions.com/#!/search?ho=t&fvf=ContentType,Journal%20Article,f%7CIsScholarly,true,f&l=en&q="
        $('#summon-search .more').append('<a href="' + more + query + '">More results</a>');
      }
    });
    //$("#riamco-search").text("Updated Riamco Text");
};


///http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}
</script>